# フォローボタン テストガイド

## 📍 テストページへのアクセス

### 1. メインテストページ
```
http://localhost:3000/test/follow-button
```
ステップバイステップでテストできる専用ページ

### 2. デモページ
```
http://localhost:3000/examples/follow
```
実際の使用例とバリエーションを確認

### 3. 簡易テストページ
```
http://localhost:3000/demo/follow-button
```
様々なバリエーションのボタンを確認

## 🧪 テスト手順

### Step 1: 環境準備

#### 1.1 開発サーバーの起動
```bash
npm run dev
```

#### 1.2 テストユーザーの作成
```bash
# テストユーザーを自動作成
node scripts/test-follow.mjs
```
これで3つのテストユーザーが作成されます：
- test.a@example.com
- test.b@example.com
- test.c@example.com

#### 1.3 ログイン
1. ブラウザで http://localhost:3000/test/follow-button にアクセス
2. 「ログイン」ボタンをクリック
3. テストユーザーでログイン

### Step 2: 基本動作テスト

#### ✅ テスト項目

1. **初期表示**
   - [ ] ボタンが「Follow」と表示される
   - [ ] ボタンが青色（primary color）
   - [ ] クリック可能な状態

2. **フォロー動作**
   - [ ] クリックで「Following」に変わる
   - [ ] 成功通知が表示される
   - [ ] ボタンの色が変わる

3. **ホバー効果**
   - [ ] Following状態でホバーすると「Unfollow」表示
   - [ ] ボタンが赤色に変わる

4. **アンフォロー動作**
   - [ ] クリックで「Follow」に戻る
   - [ ] 成功通知が表示される

### Step 3: エラーケーステスト

#### ⚠️ エラーパターン

1. **自己フォロー**
   - 期待動作: ボタンが表示されない
   - 確認方法: 自分のユーザーIDを使用

2. **未ログイン状態**
   - 期待動作: 「Log in to Follow」表示
   - 確認方法: ログアウトして確認

3. **無効なユーザーID**
   - 期待動作: エラー通知表示
   - 確認方法: 「invalid-user-id」を使用

4. **重複フォロー**
   - 期待動作: 2回目のフォローがエラー
   - 確認方法: 同じボタンを素早く2回クリック

### Step 4: ブラウザでの確認方法

#### 開発者ツールを使った確認

1. **Chrome DevTools を開く** (F12)

2. **Networkタブで確認**
   ```
   - フォロー時: POST /api/sns/follow/[userId]
   - アンフォロー時: DELETE /api/sns/follow/[userId]
   - ステータス確認: GET /api/sns/follow/[userId]
   ```

3. **Consoleタブで確認**
   ```javascript
   // フォロー状態を手動確認
   fetch('/api/sns/follow/USER_ID')
     .then(res => res.json())
     .then(console.log)
   ```

4. **Reactデバッグツール**
   - React Developer Tools拡張機能をインストール
   - Componentsタブで状態を確認

### Step 5: データベース確認

#### MongoDB Compassで確認

1. MongoDB Compassを開く
2. `users`コレクションを確認
3. フィールドを確認：
   - `followersCount`: フォロワー数
   - `followingCount`: フォロー中の数
   - `followers`: フォロワーのID配列
   - `following`: フォロー中のID配列

#### MongoDBシェルで確認
```javascript
// ユーザー情報を確認
db.users.findOne({ email: "test.a@example.com" })

// フォロー関係を確認
db.follows.find({ 
  follower: ObjectId("USER_A_ID"),
  following: ObjectId("USER_B_ID")
})
```

## 🔍 トラブルシューティング

### 問題: ボタンが無効になっている
**解決方法:**
1. ログイン状態を確認
2. セッションが有効か確認
3. ブラウザをリフレッシュ

### 問題: フォローしても変化しない
**解決方法:**
1. Networkタブでエラーを確認
2. MongoDBの接続を確認
3. 環境変数を確認

### 問題: エラー通知が表示されない
**解決方法:**
1. Consoleでエラーを確認
2. Snackbarコンポーネントの位置を確認
3. z-indexの問題を確認

## 📊 パフォーマンステスト

### 確認項目
- [ ] API応答時間 < 500ms
- [ ] ボタンの状態変更 < 100ms
- [ ] アニメーション滑らか（60fps）
- [ ] 連続クリックの制御

### 測定方法
1. Performance タブを開く
2. 録画開始
3. フォロー/アンフォローを実行
4. 録画停止して分析

## 🎯 チェックリスト

### 機能テスト
- [ ] ログイン/ログアウト状態での表示
- [ ] フォロー/アンフォロー動作
- [ ] ローディング表示
- [ ] エラー通知
- [ ] 成功通知
- [ ] ホバーエフェクト
- [ ] フォロワー数の更新

### UI/UXテスト
- [ ] レスポンシブデザイン
- [ ] ダークモード対応
- [ ] アクセシビリティ
- [ ] キーボード操作
- [ ] タッチデバイス対応

### エッジケース
- [ ] ネットワークエラー
- [ ] タイムアウト
- [ ] 同時操作
- [ ] ブラウザバック

## 📝 テスト結果記録

| テスト項目 | 結果 | 備考 |
|-----------|------|------|
| 基本フォロー | ✅/❌ | |
| アンフォロー | ✅/❌ | |
| エラー表示 | ✅/❌ | |
| ローディング | ✅/❌ | |
| 通知表示 | ✅/❌ | |

## 🚀 次のステップ

1. 本番環境でのテスト
2. 負荷テスト
3. セキュリティテスト
4. A/Bテスト